# Maria tests which require partitioning enabled

--source include/have_partition.inc
-- source include/have_maria.inc

let $default_engine=`select @@global.storage_engine`;
let $default_checksum=`select @@global.maria_page_checksum`;
set global storage_engine=maria;
set session storage_engine=maria;
set global maria_page_checksum=0;
set global maria_log_file_size=4294967295;

# Initialise
--disable_warnings
drop table if exists t1,t2;
drop view if exists v1;
--enable_warnings
SET SQL_WARNINGS=1;

#
# Bug #39227 Maria: crash with ALTER TABLE PARTITION
#

create table t1 (s1 int);
insert into t1 values (1);
--error ER_NO_PARTITION_FOR_GIVEN_VALUE
alter table t1 partition by list (s1) (partition p1 values in (2));
drop table t1;

# Set defaults back
--disable_result_log
--disable_query_log
eval set global storage_engine=$default_engine, maria_page_checksum=$default_checksum;
--enable_result_log
--enable_query_log
